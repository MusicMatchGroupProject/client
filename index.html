<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="google-signin-client_id" content="538354353006-m1asnrg9t3e0vp3j1tk30chuknv12dv7.apps.googleusercontent.com">
    <link href="https://fonts.googleapis.com/css?family=Chela+One|Chewy|Pacifico" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"> 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <title>Document</title>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1 class="title-app liniear-wipe">Music Match</h1> 
            <div class="input-group-append" style="margin-left:30%;text-align:center">
                <input type="text" class="form-control" placeholder="Search song" aria-label="Search"
                    aria-describedby="basic-addon2">
                <button class="btn btn-outline-secondary bg-light" type="button" id="search"><i class="fas fa-microphone"></i></button>
            </div>
        </div>
    </div>
    <!-- <div id="login">
        <div class="wrapper fadeInDown">
            <div id="formContent">
                <div class="fadeIn first">
                <img class="my-4" src="http://cdn.jalanroot.com/images/profile/16082018203028-apple_music_logo_by_mattroxzworld-d982zrj.png" style="width: 25%; height:25%">
                <h1 class="title-app">MusicMatch</h1>
                </div>
                <form id="login-form">
                    <input type="text" id="emailLogin" class="fadeIn second" name="login" placeholder="username">
                    <input type="password" id="passwordLogin" class="fadeIn third" name="login" placeholder="password">
                    <input type="submit"  class="fadeIn fourth" value="Log In">
                </form>
            
                <div id="formFooter">
                    <a class="g-signin2" data-onsuccess="onSignIn"></a>
                    <a class="underlineHover" href="#"> Register</a>
                </div>
            </div>
        </div>  
    </div>
    <div id="register">
        <div class="wrapper fadeInDown">
            <div id="formContent">
                <div class="fadeIn first">
                <img class="my-4" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Musixmatch_logo.svg/2000px-Musixmatch_logo.svg.png" style="width: 25%; height:25%">
                <h1>MusicMatch</h1>
                </div>
                <form id="login-form">
                    <input type="text" id="emailRegister" class="fadeIn second" name="register" placeholder="username">
                    <input type="password" id="passwordRegister" class="fadeIn third" name="register" placeholder="password">
                    <input type="text" id="firstName" class="fadeIn second" name="register" placeholder="first name">
                    <input type="text" id="lastName" class="fadeIn third" name="register" placeholder="last name">
                    <input type="submit"  class="fadeIn fourth" value="Register">
                </form>
            
                <div id="formFooter">
                    <a class="g-signin2" data-onsuccess="onSignIn"></a>
                    <a class="underlineHover" href="#"> Login</a>
                </div>
            </div>
        </div>  
    </div> -->

    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function() {
            console.log( "ready!" );
            checkLogin()
            // notFound()
        });
        window.SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;
        const recognition = new SpeechRecognition();
        let textbox = document.querySelector('.form-control');
        $('.btn').click(function () {
            console.log('start recording');
            record();
        })
        function record() {
            recognition.start();
            recognition.onresult = (event) => {
                const speechToText = event.results[0][0].transcript;
                console.log(speechToText,"=======");
                $('.form-control').val(speechToText);
            }
            recognition.onspeechend = function() {
                recognition.stop();
            }
        }
        function notFound(){
            $.get("http://localhost:3000/voice/", function( data ){
                var audio = new Audio(data)
                audio.play()
            })
        }
        $('#search').click(function() {
            recognition.start();
            console.log('Ready to receive a color command.');
        })
        $('#login-form').submit(function(e){
            e.preventDefault();
            var input = {
                email : $('#emailLogin').val(),
                password : $('#passwordLogin').val()
            }
            $.ajax({
					type: 'POST',
					url: 'http://localhost:3000/login/',
					dataType: 'json',
					data: input
				})
				.done(function(dataLogin){
					console.log(dataLogin,"ccccccc")
                    localStorage.setItem('token', dataLogin.token)
                    checkLogin()
				})
				.fail(function(error){
                    console.log(error)
            })
        })
        function checkLogin(){
            if(localStorage.getItem("token")){
                $('#app').show()
                $('#login').hide()
                $('#register').hide()
            }else{
                $('#app').hide()
                $('#register').hide()
                $('#login').show()  
            }
        }
        function logout(){
            localStorage.removeItem('token')
            signOutGoogle()
            checkLogin()
        }
    </script>
</body>
</html>